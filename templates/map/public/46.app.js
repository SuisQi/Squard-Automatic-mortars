(()=>{"use strict";var e,r,t,n,o={5046:(e,r,t)=>{var n,o,a,s;!function(e){e.creatingSession="REPLICATION_CREATING_SESSION",e.connectionReady="REPLICATION_CONNECTION_READY",e.connectionClosed="REPLICATION_CONNECTION_CLOSED",e.connectionError="REPLICATION_CONNECTION_ERROR",e.receiveMessage="REPLICATION_RECEIVE_MESSAGE",e.sendPing="REPLICATION_SEND_PING",e.noop="REPLICATION_NOOP"}(n||(n={})),function(e){e.create="SESSION_CREATE",e.started="SESSION_STARTED",e.ended="SESSION_ENDED",e.join="SESSION_JOIN",e.leave="SESSION_LEAVE",e.addUser="SESSION_ADD_USER",e.removeUser="SESSION_REMOVE_USER",e.changeUserName="SESSION_CHANGE_USER_NAME",e.userNameChanged="SESSION_USER_NAME_CHANGED",e.sendMessage="REPLICATION_SEND_MESSAGE"}(o||(o={})),function(e){e.action="ACTION",e.joined="JOINED",e.userJoined="USER_JOINED",e.userLeft="USER_LEFT",e.userChangedName="USER_CHANGED_NAME",e.error="ERROR"}(a||(a={})),function(e){e.action="ACTION",e.create="CREATE",e.join="JOIN",e.ping="PING",e.changeName="CHANGE_NAME",e.leave="LEAVE"}(s||(s={}));var i=t(7536),l=t(6511);i.A.interceptors.response.use((e=>0!==e.data.success?(l.Ay.error({message:"警告",description:e.data.message}),Promise.reject(e)):e),(e=>Promise.reject(e)));const c=`http://${"undefined"!=typeof window?window.location.hostname:self.location.hostname}:8080/`,d=e=>i.A.get(c+"set_server_ip?address="+e);let E=null,p=null,u=null,S=!1;onmessage=e=>{let r=e.data;switch(r.func){case"CREATE":return E=g(r.payload.serverAddress,r.payload.serializableState),d(r.payload.serverAddress),null;case"JOIN":return E=y(r.payload.serverAddress,r.payload.sessionId),d(r.payload.serverAddress),null;case"CHANGE_NAME":return E&&p&&((e,r)=>{e.send(JSON.stringify({command:s.changeName,payload:{name:r}}))})(E,r.payload.newName),null;case"TERMINATE":return E&&_(E),null;case"SEND":E&&p&&((e,r)=>{e.send(JSON.stringify(r))})(E,r.payload.message);default:return null}};const N=e=>{postMessage(e)},O=e=>{N({event:"DISPATCH",payload:{action:e}})},f=e=>{let r=new WebSocket(e);return r.onmessage=e=>m(e),r.onclose=e=>v(e),r.onerror=e=>A(e),r},g=(e,r)=>{let t=f(e);return I(t),t.onopen=e=>{((e,r)=>{e.send(JSON.stringify({command:s.create,payload:{state:r}}))})(t,r)},t},y=(e,r)=>{let t=f(e);return I(t),t.onopen=e=>{((e,r)=>{e.send(JSON.stringify({command:s.join,payload:{sessionId:r}}))})(t,r)},t},I=e=>{u=setInterval((()=>{(e=>{e.send(JSON.stringify({command:s.ping}))})(e)}),1e3)},_=e=>{S=!0,p=null,null!==u&&clearInterval(u);try{(e=>{e.send(JSON.stringify({command:s.leave})),e.close()})(e),e.close()}catch(e){console.log(e)}},m=e=>{let r=JSON.parse(e.data);r.command==a.error&&O({type:n.receiveMessage,payload:{message:r,sessionId:""}}),r.command==a.joined&&(p=r.payload.sessionId,N({event:"SESSION_ID",payload:r.payload})),null!==p&&O({type:n.receiveMessage,payload:{message:r,sessionId:p}})},v=e=>{E&&_(E),N({event:"CLOSE"})},A=e=>{E&&_(E),N({event:"ERROR",payload:{msg:""}})}}},a={};function s(e){var r=a[e];if(void 0!==r)return r.exports;var t=a[e]={exports:{}};return o[e](t,t.exports,s),t.exports}s.m=o,s.x=()=>{var e=s.O(void 0,[446],(()=>s(5046)));return s.O(e)},e=[],s.O=(r,t,n,o)=>{if(!t){var a=1/0;for(d=0;d<e.length;d++){for(var[t,n,o]=e[d],i=!0,l=0;l<t.length;l++)(!1&o||a>=o)&&Object.keys(s.O).every((e=>s.O[e](t[l])))?t.splice(l--,1):(i=!1,o<a&&(a=o));if(i){e.splice(d--,1);var c=n();void 0!==c&&(r=c)}}return r}o=o||0;for(var d=e.length;d>0&&e[d-1][2]>o;d--)e[d]=e[d-1];e[d]=[t,n,o]},s.n=e=>{var r=e&&e.__esModule?()=>e.default:()=>e;return s.d(r,{a:r}),r},t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,s.t=function(e,n){if(1&n&&(e=this(e)),8&n)return e;if("object"==typeof e&&e){if(4&n&&e.__esModule)return e;if(16&n&&"function"==typeof e.then)return e}var o=Object.create(null);s.r(o);var a={};r=r||[null,t({}),t([]),t(t)];for(var i=2&n&&e;"object"==typeof i&&!~r.indexOf(i);i=t(i))Object.getOwnPropertyNames(i).forEach((r=>a[r]=()=>e[r]));return a.default=()=>e,s.d(o,a),o},s.d=(e,r)=>{for(var t in r)s.o(r,t)&&!s.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:r[t]})},s.f={},s.e=e=>Promise.all(Object.keys(s.f).reduce(((r,t)=>(s.f[t](e,r),r)),[])),s.u=e=>e+".app.js",s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;s.g.importScripts&&(e=s.g.location+"");var r=s.g.document;if(!e&&r&&(r.currentScript&&(e=r.currentScript.src),!e)){var t=r.getElementsByTagName("script");if(t.length)for(var n=t.length-1;n>-1&&(!e||!/^http(s?):/.test(e));)e=t[n--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=e})(),(()=>{var e={46:1};s.f.i=(r,t)=>{e[r]||importScripts(s.p+s.u(r))};var r=self.webpackChunksquadstrat=self.webpackChunksquadstrat||[],t=r.push.bind(r);r.push=r=>{var[n,o,a]=r;for(var i in o)s.o(o,i)&&(s.m[i]=o[i]);for(a&&a(s);n.length;)e[n.pop()]=1;t(r)}})(),n=s.x,s.x=()=>s.e(446).then(n),s.x()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QmlELEVBQUVoQyxFQUFJLENBQUNpQyxFQUFTRyxLQUUvQnNCLEVBQWdCekIsSUFFbEJlLGNBQWNqRSxFQUFvQjBFLEVBQUkxRSxFQUFvQnNELEVBQUVKLEdBRTlELEVBR0QsSUFBSTBCLEVBQXFCakksS0FBNkIsdUJBQUlBLEtBQTZCLHdCQUFLLEdBQ3hGa0ksRUFBNkJELEVBQW1CRSxLQUFLQyxLQUFLSCxHQUM5REEsRUFBbUJFLEtBdkJDL0ksSUFDbkIsSUFBSzZFLEVBQVVvRSxFQUFhQyxHQUFXbEosRUFDdkMsSUFBSSxJQUFJa0UsS0FBWStFLEVBQ2hCaEYsRUFBb0I4QyxFQUFFa0MsRUFBYS9FLEtBQ3JDRCxFQUFvQk8sRUFBRU4sR0FBWStFLEVBQVkvRSxJQUloRCxJQURHZ0YsR0FBU0EsRUFBUWpGLEdBQ2RZLEVBQVNNLFFBQ2R5RCxFQUFnQi9ELEVBQVNzRSxPQUFTLEVBQ25DTCxFQUEyQjlJLEVBQUssQyxLZG5CN0JULEVBQU8wRSxFQUFvQlEsRUFDL0JSLEVBQW9CUSxFQUFJLElBQ2hCUixFQUFvQjVDLEVBQUUsS0FBS2tGLEtBQUtoSCxHZURkMEUsRUFBb0JRLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zcXVhZHN0cmF0L3dlYnBhY2svcnVudGltZS9jaHVuayBsb2FkZWQiLCJ3ZWJwYWNrOi8vc3F1YWRzdHJhdC93ZWJwYWNrL3J1bnRpbWUvY3JlYXRlIGZha2UgbmFtZXNwYWNlIG9iamVjdCIsIndlYnBhY2s6Ly9zcXVhZHN0cmF0L3dlYnBhY2svcnVudGltZS9zdGFydHVwIGNodW5rIGRlcGVuZGVuY2llcyIsIndlYnBhY2s6Ly9zcXVhZHN0cmF0Ly4vc3JjL3JlcGxpY2F0aW9uX3dzL3R5cGVzLnRzIiwid2VicGFjazovL3NxdWFkc3RyYXQvLi9zcmMvYXBpL3N0YW5kYXJkLnRzIiwid2VicGFjazovL3NxdWFkc3RyYXQvLi9zcmMvcmVwbGljYXRpb25fd3MvY29ubmVjdGlvbldvcmtlci50cyIsIndlYnBhY2s6Ly9zcXVhZHN0cmF0Ly4vc3JjL3JlcGxpY2F0aW9uX3dzL3dlYnNvY2tldFByaW1pdGl2ZXMudHMiLCJ3ZWJwYWNrOi8vc3F1YWRzdHJhdC93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9zcXVhZHN0cmF0L3dlYnBhY2svcnVudGltZS9jb21wYXQgZ2V0IGRlZmF1bHQgZXhwb3J0Iiwid2VicGFjazovL3NxdWFkc3RyYXQvd2VicGFjay9ydW50aW1lL2RlZmluZSBwcm9wZXJ0eSBnZXR0ZXJzIiwid2VicGFjazovL3NxdWFkc3RyYXQvd2VicGFjay9ydW50aW1lL2Vuc3VyZSBjaHVuayIsIndlYnBhY2s6Ly9zcXVhZHN0cmF0L3dlYnBhY2svcnVudGltZS9nZXQgamF2YXNjcmlwdCBjaHVuayBmaWxlbmFtZSIsIndlYnBhY2s6Ly9zcXVhZHN0cmF0L3dlYnBhY2svcnVudGltZS9nbG9iYWwiLCJ3ZWJwYWNrOi8vc3F1YWRzdHJhdC93ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kIiwid2VicGFjazovL3NxdWFkc3RyYXQvd2VicGFjay9ydW50aW1lL21ha2UgbmFtZXNwYWNlIG9iamVjdCIsIndlYnBhY2s6Ly9zcXVhZHN0cmF0L3dlYnBhY2svcnVudGltZS9wdWJsaWNQYXRoIiwid2VicGFjazovL3NxdWFkc3RyYXQvd2VicGFjay9ydW50aW1lL2ltcG9ydFNjcmlwdHMgY2h1bmsgbG9hZGluZyIsIndlYnBhY2s6Ly9zcXVhZHN0cmF0L3dlYnBhY2svc3RhcnR1cCJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgZGVmZXJyZWQgPSBbXTtcbl9fd2VicGFja19yZXF1aXJlX18uTyA9IChyZXN1bHQsIGNodW5rSWRzLCBmbiwgcHJpb3JpdHkpID0+IHtcblx0aWYoY2h1bmtJZHMpIHtcblx0XHRwcmlvcml0eSA9IHByaW9yaXR5IHx8IDA7XG5cdFx0Zm9yKHZhciBpID0gZGVmZXJyZWQubGVuZ3RoOyBpID4gMCAmJiBkZWZlcnJlZFtpIC0gMV1bMl0gPiBwcmlvcml0eTsgaS0tKSBkZWZlcnJlZFtpXSA9IGRlZmVycmVkW2kgLSAxXTtcblx0XHRkZWZlcnJlZFtpXSA9IFtjaHVua0lkcywgZm4sIHByaW9yaXR5XTtcblx0XHRyZXR1cm47XG5cdH1cblx0dmFyIG5vdEZ1bGZpbGxlZCA9IEluZmluaXR5O1xuXHRmb3IgKHZhciBpID0gMDsgaSA8IGRlZmVycmVkLmxlbmd0aDsgaSsrKSB7XG5cdFx0dmFyIFtjaHVua0lkcywgZm4sIHByaW9yaXR5XSA9IGRlZmVycmVkW2ldO1xuXHRcdHZhciBmdWxmaWxsZWQgPSB0cnVlO1xuXHRcdGZvciAodmFyIGogPSAwOyBqIDwgY2h1bmtJZHMubGVuZ3RoOyBqKyspIHtcblx0XHRcdGlmICgocHJpb3JpdHkgJiAxID09PSAwIHx8IG5vdEZ1bGZpbGxlZCA+PSBwcmlvcml0eSkgJiYgT2JqZWN0LmtleXMoX193ZWJwYWNrX3JlcXVpcmVfXy5PKS5ldmVyeSgoa2V5KSA9PiAoX193ZWJwYWNrX3JlcXVpcmVfXy5PW2tleV0oY2h1bmtJZHNbal0pKSkpIHtcblx0XHRcdFx0Y2h1bmtJZHMuc3BsaWNlKGotLSwgMSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRmdWxmaWxsZWQgPSBmYWxzZTtcblx0XHRcdFx0aWYocHJpb3JpdHkgPCBub3RGdWxmaWxsZWQpIG5vdEZ1bGZpbGxlZCA9IHByaW9yaXR5O1xuXHRcdFx0fVxuXHRcdH1cblx0XHRpZihmdWxmaWxsZWQpIHtcblx0XHRcdGRlZmVycmVkLnNwbGljZShpLS0sIDEpXG5cdFx0XHR2YXIgciA9IGZuKCk7XG5cdFx0XHRpZiAociAhPT0gdW5kZWZpbmVkKSByZXN1bHQgPSByO1xuXHRcdH1cblx0fVxuXHRyZXR1cm4gcmVzdWx0O1xufTsiLCJ2YXIgZ2V0UHJvdG8gPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YgPyAob2JqKSA9PiAoT2JqZWN0LmdldFByb3RvdHlwZU9mKG9iaikpIDogKG9iaikgPT4gKG9iai5fX3Byb3RvX18pO1xudmFyIGxlYWZQcm90b3R5cGVzO1xuLy8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4vLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbi8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuLy8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4vLyBtb2RlICYgMTY6IHJldHVybiB2YWx1ZSB3aGVuIGl0J3MgUHJvbWlzZS1saWtlXG4vLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG5fX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuXHRpZihtb2RlICYgMSkgdmFsdWUgPSB0aGlzKHZhbHVlKTtcblx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcblx0aWYodHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSkge1xuXHRcdGlmKChtb2RlICYgNCkgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuXHRcdGlmKChtb2RlICYgMTYpICYmIHR5cGVvZiB2YWx1ZS50aGVuID09PSAnZnVuY3Rpb24nKSByZXR1cm4gdmFsdWU7XG5cdH1cblx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcblx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcblx0dmFyIGRlZiA9IHt9O1xuXHRsZWFmUHJvdG90eXBlcyA9IGxlYWZQcm90b3R5cGVzIHx8IFtudWxsLCBnZXRQcm90byh7fSksIGdldFByb3RvKFtdKSwgZ2V0UHJvdG8oZ2V0UHJvdG8pXTtcblx0Zm9yKHZhciBjdXJyZW50ID0gbW9kZSAmIDIgJiYgdmFsdWU7IHR5cGVvZiBjdXJyZW50ID09ICdvYmplY3QnICYmICF+bGVhZlByb3RvdHlwZXMuaW5kZXhPZihjdXJyZW50KTsgY3VycmVudCA9IGdldFByb3RvKGN1cnJlbnQpKSB7XG5cdFx0T2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoY3VycmVudCkuZm9yRWFjaCgoa2V5KSA9PiAoZGVmW2tleV0gPSAoKSA9PiAodmFsdWVba2V5XSkpKTtcblx0fVxuXHRkZWZbJ2RlZmF1bHQnXSA9ICgpID0+ICh2YWx1ZSk7XG5cdF9fd2VicGFja19yZXF1aXJlX18uZChucywgZGVmKTtcblx0cmV0dXJuIG5zO1xufTsiLCJ2YXIgbmV4dCA9IF9fd2VicGFja19yZXF1aXJlX18ueDtcbl9fd2VicGFja19yZXF1aXJlX18ueCA9ICgpID0+IHtcblx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18uZSg0NDYpLnRoZW4obmV4dCk7XG59OyIsImV4cG9ydCBjb25zdCBuZXdTZXNzaW9uID0gKCkgPT4gKHtcclxuICAgIHNlc3Npb25JZDogXCJcIixcclxuICAgIHVzZXJJZDogXCJcIixcclxuICAgIHVzZXJzOiBuZXcgTWFwKCksXHJcbn0pO1xyXG5leHBvcnQgY29uc3QgbmV3UmVwbGljYXRpb25TdGF0ZSA9ICgpID0+ICh7XHJcbiAgICBjb25uZWN0aW9uU3RhdGU6IFwiY2xvc2VkXCIsXHJcbiAgICBzZXNzaW9uSWQ6IG51bGwsXHJcbn0pO1xyXG5leHBvcnQgdmFyIFJlcGxpY2F0aW9uQWN0aW9uVHlwZTtcclxuKGZ1bmN0aW9uIChSZXBsaWNhdGlvbkFjdGlvblR5cGUpIHtcclxuICAgIFJlcGxpY2F0aW9uQWN0aW9uVHlwZVtcImNyZWF0aW5nU2Vzc2lvblwiXSA9IFwiUkVQTElDQVRJT05fQ1JFQVRJTkdfU0VTU0lPTlwiO1xyXG4gICAgUmVwbGljYXRpb25BY3Rpb25UeXBlW1wiY29ubmVjdGlvblJlYWR5XCJdID0gXCJSRVBMSUNBVElPTl9DT05ORUNUSU9OX1JFQURZXCI7XHJcbiAgICBSZXBsaWNhdGlvbkFjdGlvblR5cGVbXCJjb25uZWN0aW9uQ2xvc2VkXCJdID0gXCJSRVBMSUNBVElPTl9DT05ORUNUSU9OX0NMT1NFRFwiO1xyXG4gICAgUmVwbGljYXRpb25BY3Rpb25UeXBlW1wiY29ubmVjdGlvbkVycm9yXCJdID0gXCJSRVBMSUNBVElPTl9DT05ORUNUSU9OX0VSUk9SXCI7XHJcbiAgICBSZXBsaWNhdGlvbkFjdGlvblR5cGVbXCJyZWNlaXZlTWVzc2FnZVwiXSA9IFwiUkVQTElDQVRJT05fUkVDRUlWRV9NRVNTQUdFXCI7XHJcbiAgICBSZXBsaWNhdGlvbkFjdGlvblR5cGVbXCJzZW5kUGluZ1wiXSA9IFwiUkVQTElDQVRJT05fU0VORF9QSU5HXCI7XHJcbiAgICBSZXBsaWNhdGlvbkFjdGlvblR5cGVbXCJub29wXCJdID0gXCJSRVBMSUNBVElPTl9OT09QXCI7XHJcbn0pKFJlcGxpY2F0aW9uQWN0aW9uVHlwZSB8fCAoUmVwbGljYXRpb25BY3Rpb25UeXBlID0ge30pKTtcclxuO1xyXG5leHBvcnQgdmFyIFNlc3Npb25BY3Rpb25UeXBlO1xyXG4oZnVuY3Rpb24gKFNlc3Npb25BY3Rpb25UeXBlKSB7XHJcbiAgICBTZXNzaW9uQWN0aW9uVHlwZVtcImNyZWF0ZVwiXSA9IFwiU0VTU0lPTl9DUkVBVEVcIjtcclxuICAgIFNlc3Npb25BY3Rpb25UeXBlW1wic3RhcnRlZFwiXSA9IFwiU0VTU0lPTl9TVEFSVEVEXCI7XHJcbiAgICBTZXNzaW9uQWN0aW9uVHlwZVtcImVuZGVkXCJdID0gXCJTRVNTSU9OX0VOREVEXCI7XHJcbiAgICBTZXNzaW9uQWN0aW9uVHlwZVtcImpvaW5cIl0gPSBcIlNFU1NJT05fSk9JTlwiO1xyXG4gICAgU2Vzc2lvbkFjdGlvblR5cGVbXCJsZWF2ZVwiXSA9IFwiU0VTU0lPTl9MRUFWRVwiO1xyXG4gICAgU2Vzc2lvbkFjdGlvblR5cGVbXCJhZGRVc2VyXCJdID0gXCJTRVNTSU9OX0FERF9VU0VSXCI7XHJcbiAgICBTZXNzaW9uQWN0aW9uVHlwZVtcInJlbW92ZVVzZXJcIl0gPSBcIlNFU1NJT05fUkVNT1ZFX1VTRVJcIjtcclxuICAgIFNlc3Npb25BY3Rpb25UeXBlW1wiY2hhbmdlVXNlck5hbWVcIl0gPSBcIlNFU1NJT05fQ0hBTkdFX1VTRVJfTkFNRVwiO1xyXG4gICAgU2Vzc2lvbkFjdGlvblR5cGVbXCJ1c2VyTmFtZUNoYW5nZWRcIl0gPSBcIlNFU1NJT05fVVNFUl9OQU1FX0NIQU5HRURcIjtcclxuICAgIFNlc3Npb25BY3Rpb25UeXBlW1wic2VuZE1lc3NhZ2VcIl0gPSBcIlJFUExJQ0FUSU9OX1NFTkRfTUVTU0FHRVwiO1xyXG59KShTZXNzaW9uQWN0aW9uVHlwZSB8fCAoU2Vzc2lvbkFjdGlvblR5cGUgPSB7fSkpO1xyXG47XHJcbmV4cG9ydCBjb25zdCBuZXdVc2VyID0gKGlkLCBuYW1lKSA9PiAoe1xyXG4gICAgaWQsXHJcbiAgICBuYW1lXHJcbn0pO1xyXG5leHBvcnQgdmFyIFJlcGxpY2F0aW9uTWVzc2FnZVR5cGU7XHJcbihmdW5jdGlvbiAoUmVwbGljYXRpb25NZXNzYWdlVHlwZSkge1xyXG4gICAgUmVwbGljYXRpb25NZXNzYWdlVHlwZVtcImFjdGlvblwiXSA9IFwiQUNUSU9OXCI7XHJcbiAgICAvL2NyZWF0ZWQgPSBcIkNSRUFURURcIiwgLy8gc2VydmVyIGRvZXMgbm90IHRlbGwgeW91IHRoYXRcclxuICAgIFJlcGxpY2F0aW9uTWVzc2FnZVR5cGVbXCJqb2luZWRcIl0gPSBcIkpPSU5FRFwiO1xyXG4gICAgUmVwbGljYXRpb25NZXNzYWdlVHlwZVtcInVzZXJKb2luZWRcIl0gPSBcIlVTRVJfSk9JTkVEXCI7XHJcbiAgICBSZXBsaWNhdGlvbk1lc3NhZ2VUeXBlW1widXNlckxlZnRcIl0gPSBcIlVTRVJfTEVGVFwiO1xyXG4gICAgUmVwbGljYXRpb25NZXNzYWdlVHlwZVtcInVzZXJDaGFuZ2VkTmFtZVwiXSA9IFwiVVNFUl9DSEFOR0VEX05BTUVcIjtcclxuICAgIFJlcGxpY2F0aW9uTWVzc2FnZVR5cGVbXCJlcnJvclwiXSA9IFwiRVJST1JcIjtcclxufSkoUmVwbGljYXRpb25NZXNzYWdlVHlwZSB8fCAoUmVwbGljYXRpb25NZXNzYWdlVHlwZSA9IHt9KSk7XHJcbmV4cG9ydCB2YXIgQ2xpZW50UmVxdWVzdFR5cGU7XHJcbihmdW5jdGlvbiAoQ2xpZW50UmVxdWVzdFR5cGUpIHtcclxuICAgIENsaWVudFJlcXVlc3RUeXBlW1wiYWN0aW9uXCJdID0gXCJBQ1RJT05cIjtcclxuICAgIENsaWVudFJlcXVlc3RUeXBlW1wiY3JlYXRlXCJdID0gXCJDUkVBVEVcIjtcclxuICAgIENsaWVudFJlcXVlc3RUeXBlW1wiam9pblwiXSA9IFwiSk9JTlwiO1xyXG4gICAgQ2xpZW50UmVxdWVzdFR5cGVbXCJwaW5nXCJdID0gXCJQSU5HXCI7XHJcbiAgICBDbGllbnRSZXF1ZXN0VHlwZVtcImNoYW5nZU5hbWVcIl0gPSBcIkNIQU5HRV9OQU1FXCI7XHJcbiAgICBDbGllbnRSZXF1ZXN0VHlwZVtcImxlYXZlXCJdID0gXCJMRUFWRVwiO1xyXG59KShDbGllbnRSZXF1ZXN0VHlwZSB8fCAoQ2xpZW50UmVxdWVzdFR5cGUgPSB7fSkpO1xyXG4iLCJpbXBvcnQgYXhpb3MgZnJvbSBcImF4aW9zXCI7XHJcbmltcG9ydCB7IG5vdGlmaWNhdGlvbiB9IGZyb20gJ2FudGQnO1xyXG5heGlvcy5pbnRlcmNlcHRvcnMucmVzcG9uc2UudXNlKHJlcyA9PiB7XHJcbiAgICBpZiAocmVzLmRhdGEuc3VjY2VzcyAhPT0gMCkge1xyXG4gICAgICAgIG5vdGlmaWNhdGlvbi5lcnJvcih7XHJcbiAgICAgICAgICAgIG1lc3NhZ2U6ICforablkYonLFxyXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogcmVzLmRhdGEubWVzc2FnZSxcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QocmVzKTtcclxuICAgIH1cclxuICAgIC8vIOWvueWTjeW6lOaVsOaNruWBmueCueS7gOS5iFxyXG4gICAgcmV0dXJuIHJlcztcclxufSwgZXJyb3IgPT4ge1xyXG4gICAgLy8g5a+55ZON5bqU6ZSZ6K+v5YGa54K55LuA5LmIXHJcbiAgICAvLyBpZiAoZXJyb3IucmVzcG9uc2Uuc3RhdHVzID09PSA0MDEpIHtcclxuICAgIC8vICAgICAvLyDlpITnkIbmnKrmjojmnYPnmoTmg4XlhrVcclxuICAgIC8vICAgICAvLyDkvovlpoLph43lrprlkJHliLDnmbvlvZXpobXpnaJcclxuICAgIC8vIH1cclxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7XHJcbn0pO1xyXG5jb25zdCBiYXNlVVJMID0gYGh0dHA6Ly8keyh0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiKSA/IHdpbmRvdy5sb2NhdGlvbi5ob3N0bmFtZSA6IHNlbGYubG9jYXRpb24uaG9zdG5hbWV9OjgwODAvYDtcclxuZXhwb3J0IGNvbnN0IHNhdmUgPSAoZGF0YSkgPT4ge1xyXG4gICAgcmV0dXJuIGF4aW9zLnBvc3QoYmFzZVVSTCArIFwic2F2ZVwiLCBkYXRhKTtcclxufTtcclxuZXhwb3J0IGNvbnN0IHJlbW92ZSA9IChkYXRhKSA9PiB7XHJcbiAgICByZXR1cm4gYXhpb3MucG9zdChiYXNlVVJMICsgXCJyZW1vdmVcIiwgZGF0YSk7XHJcbn07XHJcbmV4cG9ydCBjb25zdCB1cGRhdGUgPSAoZGF0YSkgPT4ge1xyXG4gICAgcmV0dXJuIGF4aW9zLnBvc3QoYmFzZVVSTCArIFwidXBkYXRlXCIsIGRhdGEpO1xyXG59O1xyXG5leHBvcnQgY29uc3QgcmVtb3ZlX2FsbCA9ICgpID0+IHtcclxuICAgIHJldHVybiBheGlvcy5nZXQoYmFzZVVSTCArIFwicmVtb3ZlX2FsbFwiKTtcclxufTtcclxuZXhwb3J0IGNvbnN0IHNldF9zZXNzaW9uX3VzZXJJZCA9ICh1c2VySWQpID0+IHtcclxuICAgIHJldHVybiBheGlvcy5nZXQoYmFzZVVSTCArIFwic2V0X3Nlc3Npb25fdXNlcklkP3VzZXJJZD1cIiArIHVzZXJJZCk7XHJcbn07XHJcbmV4cG9ydCBjb25zdCBzZXRfc2Vzc2lvbklkID0gKHNlc3Npb25JZCkgPT4ge1xyXG4gICAgcmV0dXJuIGF4aW9zLmdldChiYXNlVVJMICsgXCJzZXRfc2Vzc2lvbklkP3Nlc3Npb25JZD1cIiArIHNlc3Npb25JZCk7XHJcbn07XHJcbmV4cG9ydCBjb25zdCBzZXRfc2VydmVyX2lwID0gKGFkZHJlc3MpID0+IHtcclxuICAgIHJldHVybiBheGlvcy5nZXQoYmFzZVVSTCArIFwic2V0X3NlcnZlcl9pcD9hZGRyZXNzPVwiICsgYWRkcmVzcyk7XHJcbn07XHJcbiIsImltcG9ydCB7IFJlcGxpY2F0aW9uQWN0aW9uVHlwZSBhcyBSQVQsIFJlcGxpY2F0aW9uTWVzc2FnZVR5cGUgfSBmcm9tIFwiLi90eXBlc1wiO1xyXG5pbXBvcnQgKiBhcyBXUyBmcm9tIFwiLi93ZWJzb2NrZXRQcmltaXRpdmVzXCI7XHJcbmltcG9ydCB7IHNldF9zZXJ2ZXJfaXAgfSBmcm9tIFwiLi4vYXBpL3N0YW5kYXJkXCI7XHJcbi8vY29uc29sZS5sb2coXCJ3ZWJ3b3JrZXIgcnVubmluZ1wiKVxyXG5sZXQgd3MgPSBudWxsO1xyXG5sZXQgc2Vzc2lvbklkID0gbnVsbDtcclxubGV0IHBpbmdUaW1lciA9IG51bGw7XHJcbmxldCB3c0Nsb3NlZCA9IGZhbHNlO1xyXG4vLyBXb3JrZXIgJ0lPJ1xyXG5vbm1lc3NhZ2UgPSAoZSkgPT4ge1xyXG4gICAgbGV0IG1lc3NhZ2UgPSBlLmRhdGE7XHJcbiAgICBzd2l0Y2ggKG1lc3NhZ2UuZnVuYykge1xyXG4gICAgICAgIGNhc2UgXCJDUkVBVEVcIjpcclxuICAgICAgICAgICAgd3MgPSBjcmVhdGUobWVzc2FnZS5wYXlsb2FkLnNlcnZlckFkZHJlc3MsIG1lc3NhZ2UucGF5bG9hZC5zZXJpYWxpemFibGVTdGF0ZSk7XHJcbiAgICAgICAgICAgIHNldF9zZXJ2ZXJfaXAobWVzc2FnZS5wYXlsb2FkLnNlcnZlckFkZHJlc3MpO1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICBjYXNlIFwiSk9JTlwiOlxyXG4gICAgICAgICAgICB3cyA9IGpvaW4obWVzc2FnZS5wYXlsb2FkLnNlcnZlckFkZHJlc3MsIG1lc3NhZ2UucGF5bG9hZC5zZXNzaW9uSWQpO1xyXG4gICAgICAgICAgICBzZXRfc2VydmVyX2lwKG1lc3NhZ2UucGF5bG9hZC5zZXJ2ZXJBZGRyZXNzKTtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgY2FzZSBcIkNIQU5HRV9OQU1FXCI6XHJcbiAgICAgICAgICAgIGlmICh3cyAmJiBzZXNzaW9uSWQpXHJcbiAgICAgICAgICAgICAgICBXUy5jaGFuZ2VOYW1lKHdzLCBtZXNzYWdlLnBheWxvYWQubmV3TmFtZSk7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIGNhc2UgXCJURVJNSU5BVEVcIjpcclxuICAgICAgICAgICAgaWYgKHdzKVxyXG4gICAgICAgICAgICAgICAgdGVybWluYXRlKHdzKTtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgY2FzZSBcIlNFTkRcIjpcclxuICAgICAgICAgICAgaWYgKHdzICYmIHNlc3Npb25JZClcclxuICAgICAgICAgICAgICAgIFdTLnNlbmQod3MsIG1lc3NhZ2UucGF5bG9hZC5tZXNzYWdlKTtcclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxufTtcclxuY29uc3Qgc2VuZFRvTWFpbiA9IChtZXNzYWdlKSA9PiB7XHJcbiAgICBwb3N0TWVzc2FnZShtZXNzYWdlKTtcclxufTtcclxuY29uc3QgZGlzcGF0Y2ggPSAoYWN0aW9uKSA9PiB7XHJcbiAgICBzZW5kVG9NYWluKHsgZXZlbnQ6IFwiRElTUEFUQ0hcIiwgcGF5bG9hZDogeyBhY3Rpb24gfSB9KTtcclxufTtcclxuLy8gQ29ubmVjdGlvbiBzZXR1cFxyXG5jb25zdCBjb25zdHJ1Y3RvciA9IChzZXJ2ZXJBZGRyZXNzKSA9PiB7XHJcbiAgICBsZXQgd3MgPSBuZXcgV2ViU29ja2V0KHNlcnZlckFkZHJlc3MpO1xyXG4gICAgd3Mub25tZXNzYWdlID0gKGV2KSA9PiBvbk1lc3NhZ2UoZXYpO1xyXG4gICAgd3Mub25jbG9zZSA9IChldikgPT4gb25DbG9zZShldik7XHJcbiAgICB3cy5vbmVycm9yID0gKGV2KSA9PiBvbkVycm9yKGV2KTtcclxuICAgIHJldHVybiB3cztcclxufTtcclxuY29uc3QgY3JlYXRlID0gKHNlcnZlckFkZHJlc3MsIHNlcmlhbGl6YWJsZVN0YXRlKSA9PiB7XHJcbiAgICBsZXQgd3MgPSBjb25zdHJ1Y3RvcihzZXJ2ZXJBZGRyZXNzKTtcclxuICAgIHN0YXJ0UGluZ1RpbWVyKHdzKTtcclxuICAgIHdzLm9ub3BlbiA9IChldikgPT4ge1xyXG4gICAgICAgIFdTLmNyZWF0ZVNlc3Npb24od3MsIHNlcmlhbGl6YWJsZVN0YXRlKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gd3M7XHJcbn07XHJcbmNvbnN0IGpvaW4gPSAoc2VydmVyQWRkcmVzcywgc2Vzc2lvbklkKSA9PiB7XHJcbiAgICBsZXQgd3MgPSBjb25zdHJ1Y3RvcihzZXJ2ZXJBZGRyZXNzKTtcclxuICAgIHN0YXJ0UGluZ1RpbWVyKHdzKTtcclxuICAgIHdzLm9ub3BlbiA9IChldikgPT4ge1xyXG4gICAgICAgIFdTLmpvaW5TZXNzaW9uKHdzLCBzZXNzaW9uSWQpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiB3cztcclxufTtcclxuY29uc3Qgc3RhcnRQaW5nVGltZXIgPSAod3MpID0+IHtcclxuICAgIHBpbmdUaW1lciA9IHNldEludGVydmFsKCgpID0+IHtcclxuICAgICAgICBXUy5zZW5kUGluZyh3cyk7XHJcbiAgICB9LCAxMDAwKTtcclxufTtcclxuLy8gdGVhcmRvd25cclxuY29uc3QgdGVybWluYXRlID0gKHdzKSA9PiB7XHJcbiAgICB3c0Nsb3NlZCA9IHRydWU7XHJcbiAgICBzZXNzaW9uSWQgPSBudWxsO1xyXG4gICAgaWYgKHBpbmdUaW1lciAhPT0gbnVsbClcclxuICAgICAgICBjbGVhckludGVydmFsKHBpbmdUaW1lcik7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIFdTLmxlYXZlU2Vzc2lvbih3cyk7XHJcbiAgICAgICAgd3MuY2xvc2UoKTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcclxuICAgICAgICAvLyBub3RoaW5nIHRvIGRvIGhlcmUuXHJcbiAgICB9XHJcbn07XHJcbi8vIFdlYnNvY2tldCBiZWhhdmlvclxyXG5jb25zdCBvbk1lc3NhZ2UgPSAoZXYpID0+IHtcclxuICAgIGxldCBtZXNzYWdlID0gSlNPTi5wYXJzZShldi5kYXRhKTtcclxuICAgIGlmIChtZXNzYWdlLmNvbW1hbmQgPT0gUmVwbGljYXRpb25NZXNzYWdlVHlwZS5lcnJvcikge1xyXG4gICAgICAgIGRpc3BhdGNoKHsgdHlwZTogUkFULnJlY2VpdmVNZXNzYWdlLCBwYXlsb2FkOiB7IG1lc3NhZ2UsIHNlc3Npb25JZDogXCJcIiB9IH0pO1xyXG4gICAgfVxyXG4gICAgaWYgKG1lc3NhZ2UuY29tbWFuZCA9PSBSZXBsaWNhdGlvbk1lc3NhZ2VUeXBlLmpvaW5lZCkge1xyXG4gICAgICAgIHNlc3Npb25JZCA9IG1lc3NhZ2UucGF5bG9hZC5zZXNzaW9uSWQ7XHJcbiAgICAgICAgc2VuZFRvTWFpbih7IGV2ZW50OiBcIlNFU1NJT05fSURcIiwgcGF5bG9hZDogbWVzc2FnZS5wYXlsb2FkIH0pO1xyXG4gICAgfVxyXG4gICAgaWYgKHNlc3Npb25JZCAhPT0gbnVsbCkge1xyXG4gICAgICAgIGRpc3BhdGNoKHsgdHlwZTogUkFULnJlY2VpdmVNZXNzYWdlLCBwYXlsb2FkOiB7IG1lc3NhZ2UsIHNlc3Npb25JZDogc2Vzc2lvbklkIH0gfSk7XHJcbiAgICB9XHJcbn07XHJcbmNvbnN0IG9uQ2xvc2UgPSAoZXYpID0+IHtcclxuICAgIGlmICh3cylcclxuICAgICAgICB0ZXJtaW5hdGUod3MpO1xyXG4gICAgc2VuZFRvTWFpbih7IGV2ZW50OiBcIkNMT1NFXCIgfSk7XHJcbn07XHJcbmNvbnN0IG9uRXJyb3IgPSAoZXYpID0+IHtcclxuICAgIGlmICh3cylcclxuICAgICAgICB0ZXJtaW5hdGUod3MpO1xyXG4gICAgc2VuZFRvTWFpbih7IGV2ZW50OiBcIkVSUk9SXCIsIHBheWxvYWQ6IHsgbXNnOiBcIlwiIH0gfSk7XHJcbn07XHJcbiIsImltcG9ydCB7IENsaWVudFJlcXVlc3RUeXBlIH0gZnJvbSBcIi4uL3JlcGxpY2F0aW9uX3dzL3R5cGVzXCI7XHJcbi8qIGZvciByZWZlcmVuY2Ugb25seVxyXG5jb25zdCBuZXdDb25uZWN0aW9uID0gKFxyXG4gIHVyaTogc3RyaW5nLFxyXG4gIG9uT3BlbjogKGV2OiBFdmVudCkgPT4gYW55LFxyXG4gIG9uTWVzc2FnZTogKGV2OiBNZXNzYWdlRXZlbnQpID0+IGFueSxcclxuICBvbkNsb3NlOiAoZXY6IENsb3NlRXZlbnQpID0+IGFueSxcclxuICBvbkVycm9yOiAoZXY6IEV2ZW50KSA9PiBhbnlcclxuKTogV2ViU29ja2V0ID0+IHtcclxuICBsZXQgd3MgPSBuZXcgV2ViU29ja2V0KHVyaSk7XHJcbiAgd3Mub25vcGVuID0gb25PcGVuO1xyXG4gIHdzLm9ubWVzc2FnZSA9IChldjogTWVzc2FnZUV2ZW50KTogYW55ID0+IHtcclxuICAgIC8vY29uc29sZS5sb2coXCJtZXNzYWdlOiBcIiwgZXYuZGF0YSk7XHJcbiAgICBvbk1lc3NhZ2UoZXYpO1xyXG4gIH07XHJcbiAgd3Mub25jbG9zZSA9IChldjogQ2xvc2VFdmVudCk6IGFueSA9PiB7XHJcbiAgICBvbkNsb3NlKGV2KTtcclxuICB9O1xyXG4gIHdzLm9uZXJyb3IgPSBvbkVycm9yO1xyXG4gIHJldHVybiB3cztcclxufVxyXG4qL1xyXG5leHBvcnQgY29uc3Qgc2VuZCA9ICh3cywgbWVzc2FnZSkgPT4ge1xyXG4gICAgd3Muc2VuZChKU09OLnN0cmluZ2lmeShtZXNzYWdlKSk7XHJcbn07XHJcbmV4cG9ydCBjb25zdCBzZW5kUGluZyA9ICh3cykgPT4ge1xyXG4gICAgLy9jb25zb2xlLmxvZyhcInNlbmRpbmcgcGluZ1wiKVxyXG4gICAgd3Muc2VuZChKU09OLnN0cmluZ2lmeSh7IGNvbW1hbmQ6IENsaWVudFJlcXVlc3RUeXBlLnBpbmcgfSkpO1xyXG59O1xyXG5leHBvcnQgY29uc3QgY3JlYXRlU2Vzc2lvbiA9ICh3cywgc2VyaXphYmxlU3RhdGUpID0+IHtcclxuICAgIHdzLnNlbmQoSlNPTi5zdHJpbmdpZnkoeyBjb21tYW5kOiBDbGllbnRSZXF1ZXN0VHlwZS5jcmVhdGUsIHBheWxvYWQ6IHsgc3RhdGU6IHNlcml6YWJsZVN0YXRlIH0gfSkpO1xyXG59O1xyXG5leHBvcnQgY29uc3Qgam9pblNlc3Npb24gPSAod3MsIHNlc3Npb25JZCkgPT4ge1xyXG4gICAgd3Muc2VuZChKU09OLnN0cmluZ2lmeSh7IGNvbW1hbmQ6IENsaWVudFJlcXVlc3RUeXBlLmpvaW4sIHBheWxvYWQ6IHsgc2Vzc2lvbklkIH0gfSkpO1xyXG59O1xyXG5leHBvcnQgY29uc3QgY2hhbmdlTmFtZSA9ICh3cywgbmFtZSkgPT4ge1xyXG4gICAgd3Muc2VuZChKU09OLnN0cmluZ2lmeSh7IGNvbW1hbmQ6IENsaWVudFJlcXVlc3RUeXBlLmNoYW5nZU5hbWUsIHBheWxvYWQ6IHsgbmFtZSB9IH0pKTtcclxufTtcclxuZXhwb3J0IGNvbnN0IGxlYXZlU2Vzc2lvbiA9ICh3cykgPT4ge1xyXG4gICAgd3Muc2VuZChKU09OLnN0cmluZ2lmeSh7IGNvbW1hbmQ6IENsaWVudFJlcXVlc3RUeXBlLmxlYXZlIH0pKTtcclxuICAgIHdzLmNsb3NlKCk7XHJcbn07XHJcbiIsIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuXHRpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcblx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0obW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4vLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuX193ZWJwYWNrX3JlcXVpcmVfXy5tID0gX193ZWJwYWNrX21vZHVsZXNfXztcblxuLy8gdGhlIHN0YXJ0dXAgZnVuY3Rpb25cbl9fd2VicGFja19yZXF1aXJlX18ueCA9ICgpID0+IHtcblx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG5cdC8vIFRoaXMgZW50cnkgbW9kdWxlIGRlcGVuZHMgb24gb3RoZXIgbG9hZGVkIGNodW5rcyBhbmQgZXhlY3V0aW9uIG5lZWQgdG8gYmUgZGVsYXllZFxuXHR2YXIgX193ZWJwYWNrX2V4cG9ydHNfXyA9IF9fd2VicGFja19yZXF1aXJlX18uTyh1bmRlZmluZWQsIFs0NDZdLCAoKSA9PiAoX193ZWJwYWNrX3JlcXVpcmVfXyg1MDQ2KSkpXG5cdF9fd2VicGFja19leHBvcnRzX18gPSBfX3dlYnBhY2tfcmVxdWlyZV9fLk8oX193ZWJwYWNrX2V4cG9ydHNfXyk7XG5cdHJldHVybiBfX3dlYnBhY2tfZXhwb3J0c19fO1xufTtcblxuIiwiLy8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbl9fd2VicGFja19yZXF1aXJlX18ubiA9IChtb2R1bGUpID0+IHtcblx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG5cdFx0KCkgPT4gKG1vZHVsZVsnZGVmYXVsdCddKSA6XG5cdFx0KCkgPT4gKG1vZHVsZSk7XG5cdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsIHsgYTogZ2V0dGVyIH0pO1xuXHRyZXR1cm4gZ2V0dGVyO1xufTsiLCIvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9ucyBmb3IgaGFybW9ueSBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSAoZXhwb3J0cywgZGVmaW5pdGlvbikgPT4ge1xuXHRmb3IodmFyIGtleSBpbiBkZWZpbml0aW9uKSB7XG5cdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGRlZmluaXRpb24sIGtleSkgJiYgIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBrZXkpKSB7XG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZGVmaW5pdGlvbltrZXldIH0pO1xuXHRcdH1cblx0fVxufTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLmYgPSB7fTtcbi8vIFRoaXMgZmlsZSBjb250YWlucyBvbmx5IHRoZSBlbnRyeSBjaHVuay5cbi8vIFRoZSBjaHVuayBsb2FkaW5nIGZ1bmN0aW9uIGZvciBhZGRpdGlvbmFsIGNodW5rc1xuX193ZWJwYWNrX3JlcXVpcmVfXy5lID0gKGNodW5rSWQpID0+IHtcblx0cmV0dXJuIFByb21pc2UuYWxsKE9iamVjdC5rZXlzKF9fd2VicGFja19yZXF1aXJlX18uZikucmVkdWNlKChwcm9taXNlcywga2V5KSA9PiB7XG5cdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5mW2tleV0oY2h1bmtJZCwgcHJvbWlzZXMpO1xuXHRcdHJldHVybiBwcm9taXNlcztcblx0fSwgW10pKTtcbn07IiwiLy8gVGhpcyBmdW5jdGlvbiBhbGxvdyB0byByZWZlcmVuY2UgYXN5bmMgY2h1bmtzIGFuZCBzaWJsaW5nIGNodW5rcyBmb3IgdGhlIGVudHJ5cG9pbnRcbl9fd2VicGFja19yZXF1aXJlX18udSA9IChjaHVua0lkKSA9PiB7XG5cdC8vIHJldHVybiB1cmwgZm9yIGZpbGVuYW1lcyBiYXNlZCBvbiB0ZW1wbGF0ZVxuXHRyZXR1cm4gXCJcIiArIGNodW5rSWQgKyBcIi5hcHAuanNcIjtcbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5nID0gKGZ1bmN0aW9uKCkge1xuXHRpZiAodHlwZW9mIGdsb2JhbFRoaXMgPT09ICdvYmplY3QnKSByZXR1cm4gZ2xvYmFsVGhpcztcblx0dHJ5IHtcblx0XHRyZXR1cm4gdGhpcyB8fCBuZXcgRnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKTtcblx0fSBjYXRjaCAoZSkge1xuXHRcdGlmICh0eXBlb2Ygd2luZG93ID09PSAnb2JqZWN0JykgcmV0dXJuIHdpbmRvdztcblx0fVxufSkoKTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSAob2JqLCBwcm9wKSA9PiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCkpIiwiLy8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5yID0gKGV4cG9ydHMpID0+IHtcblx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG5cdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG5cdH1cblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbn07IiwidmFyIHNjcmlwdFVybDtcbmlmIChfX3dlYnBhY2tfcmVxdWlyZV9fLmcuaW1wb3J0U2NyaXB0cykgc2NyaXB0VXJsID0gX193ZWJwYWNrX3JlcXVpcmVfXy5nLmxvY2F0aW9uICsgXCJcIjtcbnZhciBkb2N1bWVudCA9IF9fd2VicGFja19yZXF1aXJlX18uZy5kb2N1bWVudDtcbmlmICghc2NyaXB0VXJsICYmIGRvY3VtZW50KSB7XG5cdGlmIChkb2N1bWVudC5jdXJyZW50U2NyaXB0KVxuXHRcdHNjcmlwdFVybCA9IGRvY3VtZW50LmN1cnJlbnRTY3JpcHQuc3JjO1xuXHRpZiAoIXNjcmlwdFVybCkge1xuXHRcdHZhciBzY3JpcHRzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJzY3JpcHRcIik7XG5cdFx0aWYoc2NyaXB0cy5sZW5ndGgpIHtcblx0XHRcdHZhciBpID0gc2NyaXB0cy5sZW5ndGggLSAxO1xuXHRcdFx0d2hpbGUgKGkgPiAtMSAmJiAoIXNjcmlwdFVybCB8fCAhL15odHRwKHM/KTovLnRlc3Qoc2NyaXB0VXJsKSkpIHNjcmlwdFVybCA9IHNjcmlwdHNbaS0tXS5zcmM7XG5cdFx0fVxuXHR9XG59XG4vLyBXaGVuIHN1cHBvcnRpbmcgYnJvd3NlcnMgd2hlcmUgYW4gYXV0b21hdGljIHB1YmxpY1BhdGggaXMgbm90IHN1cHBvcnRlZCB5b3UgbXVzdCBzcGVjaWZ5IGFuIG91dHB1dC5wdWJsaWNQYXRoIG1hbnVhbGx5IHZpYSBjb25maWd1cmF0aW9uXG4vLyBvciBwYXNzIGFuIGVtcHR5IHN0cmluZyAoXCJcIikgYW5kIHNldCB0aGUgX193ZWJwYWNrX3B1YmxpY19wYXRoX18gdmFyaWFibGUgZnJvbSB5b3VyIGNvZGUgdG8gdXNlIHlvdXIgb3duIGxvZ2ljLlxuaWYgKCFzY3JpcHRVcmwpIHRocm93IG5ldyBFcnJvcihcIkF1dG9tYXRpYyBwdWJsaWNQYXRoIGlzIG5vdCBzdXBwb3J0ZWQgaW4gdGhpcyBicm93c2VyXCIpO1xuc2NyaXB0VXJsID0gc2NyaXB0VXJsLnJlcGxhY2UoLyMuKiQvLCBcIlwiKS5yZXBsYWNlKC9cXD8uKiQvLCBcIlwiKS5yZXBsYWNlKC9cXC9bXlxcL10rJC8sIFwiL1wiKTtcbl9fd2VicGFja19yZXF1aXJlX18ucCA9IHNjcmlwdFVybDsiLCIvLyBubyBiYXNlVVJJXG5cbi8vIG9iamVjdCB0byBzdG9yZSBsb2FkZWQgY2h1bmtzXG4vLyBcIjFcIiBtZWFucyBcImFscmVhZHkgbG9hZGVkXCJcbnZhciBpbnN0YWxsZWRDaHVua3MgPSB7XG5cdDQ2OiAxXG59O1xuXG4vLyBpbXBvcnRTY3JpcHRzIGNodW5rIGxvYWRpbmdcbnZhciBpbnN0YWxsQ2h1bmsgPSAoZGF0YSkgPT4ge1xuXHR2YXIgW2NodW5rSWRzLCBtb3JlTW9kdWxlcywgcnVudGltZV0gPSBkYXRhO1xuXHRmb3IodmFyIG1vZHVsZUlkIGluIG1vcmVNb2R1bGVzKSB7XG5cdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKG1vcmVNb2R1bGVzLCBtb2R1bGVJZCkpIHtcblx0XHRcdF9fd2VicGFja19yZXF1aXJlX18ubVttb2R1bGVJZF0gPSBtb3JlTW9kdWxlc1ttb2R1bGVJZF07XG5cdFx0fVxuXHR9XG5cdGlmKHJ1bnRpbWUpIHJ1bnRpbWUoX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cdHdoaWxlKGNodW5rSWRzLmxlbmd0aClcblx0XHRpbnN0YWxsZWRDaHVua3NbY2h1bmtJZHMucG9wKCldID0gMTtcblx0cGFyZW50Q2h1bmtMb2FkaW5nRnVuY3Rpb24oZGF0YSk7XG59O1xuX193ZWJwYWNrX3JlcXVpcmVfXy5mLmkgPSAoY2h1bmtJZCwgcHJvbWlzZXMpID0+IHtcblx0Ly8gXCIxXCIgaXMgdGhlIHNpZ25hbCBmb3IgXCJhbHJlYWR5IGxvYWRlZFwiXG5cdGlmKCFpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF0pIHtcblx0XHRpZih0cnVlKSB7IC8vIGFsbCBjaHVua3MgaGF2ZSBKU1xuXHRcdFx0aW1wb3J0U2NyaXB0cyhfX3dlYnBhY2tfcmVxdWlyZV9fLnAgKyBfX3dlYnBhY2tfcmVxdWlyZV9fLnUoY2h1bmtJZCkpO1xuXHRcdH1cblx0fVxufTtcblxudmFyIGNodW5rTG9hZGluZ0dsb2JhbCA9IHNlbGZbXCJ3ZWJwYWNrQ2h1bmtzcXVhZHN0cmF0XCJdID0gc2VsZltcIndlYnBhY2tDaHVua3NxdWFkc3RyYXRcIl0gfHwgW107XG52YXIgcGFyZW50Q2h1bmtMb2FkaW5nRnVuY3Rpb24gPSBjaHVua0xvYWRpbmdHbG9iYWwucHVzaC5iaW5kKGNodW5rTG9hZGluZ0dsb2JhbCk7XG5jaHVua0xvYWRpbmdHbG9iYWwucHVzaCA9IGluc3RhbGxDaHVuaztcblxuLy8gbm8gSE1SXG5cbi8vIG5vIEhNUiBtYW5pZmVzdCIsIi8vIHJ1biBzdGFydHVwXG52YXIgX193ZWJwYWNrX2V4cG9ydHNfXyA9IF9fd2VicGFja19yZXF1aXJlX18ueCgpO1xuIl0sIm5hbWVzIjpbImRlZmVycmVkIiwibGVhZlByb3RvdHlwZXMiLCJnZXRQcm90byIsIm5leHQiLCJSZXBsaWNhdGlvbkFjdGlvblR5cGUiLCJTZXNzaW9uQWN0aW9uVHlwZSIsIlJlcGxpY2F0aW9uTWVzc2FnZVR5cGUiLCJDbGllbnRSZXF1ZXN0VHlwZSIsImludGVyY2VwdG9ycyIsInJlc3BvbnNlIiwidXNlIiwicmVzIiwiZGF0YSIsInN1Y2Nlc3MiLCJub3RpZmljYXRpb24iLCJlcnJvciIsIm1lc3NhZ2UiLCJkZXNjcmlwdGlvbiIsIlByb21pc2UiLCJyZWplY3QiLCJiYXNlVVJMIiwid2luZG93IiwibG9jYXRpb24iLCJob3N0bmFtZSIsInNlbGYiLCJzZXRfc2VydmVyX2lwIiwiYWRkcmVzcyIsImdldCIsIndzIiwic2Vzc2lvbklkIiwicGluZ1RpbWVyIiwid3NDbG9zZWQiLCJvbm1lc3NhZ2UiLCJlIiwiZnVuYyIsImNyZWF0ZSIsInBheWxvYWQiLCJzZXJ2ZXJBZGRyZXNzIiwic2VyaWFsaXphYmxlU3RhdGUiLCJqb2luIiwibmFtZSIsInNlbmQiLCJKU09OIiwic3RyaW5naWZ5IiwiY29tbWFuZCIsImNoYW5nZU5hbWUiLCJuZXdOYW1lIiwidGVybWluYXRlIiwic2VuZFRvTWFpbiIsInBvc3RNZXNzYWdlIiwiZGlzcGF0Y2giLCJhY3Rpb24iLCJldmVudCIsIldlYlNvY2tldCIsImV2Iiwib25NZXNzYWdlIiwib25jbG9zZSIsIm9uQ2xvc2UiLCJvbmVycm9yIiwib25FcnJvciIsInN0YXJ0UGluZ1RpbWVyIiwib25vcGVuIiwic2VyaXphYmxlU3RhdGUiLCJzdGF0ZSIsInNldEludGVydmFsIiwicGluZyIsImNsZWFySW50ZXJ2YWwiLCJsZWF2ZSIsImNsb3NlIiwiY29uc29sZSIsImxvZyIsInBhcnNlIiwidHlwZSIsInJlY2VpdmVNZXNzYWdlIiwiam9pbmVkIiwibXNnIiwiX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiY2FjaGVkTW9kdWxlIiwidW5kZWZpbmVkIiwiZXhwb3J0cyIsIm1vZHVsZSIsIl9fd2VicGFja19tb2R1bGVzX18iLCJtIiwieCIsIl9fd2VicGFja19leHBvcnRzX18iLCJPIiwicmVzdWx0IiwiY2h1bmtJZHMiLCJmbiIsInByaW9yaXR5Iiwibm90RnVsZmlsbGVkIiwiSW5maW5pdHkiLCJpIiwibGVuZ3RoIiwiZnVsZmlsbGVkIiwiaiIsIk9iamVjdCIsImtleXMiLCJldmVyeSIsImtleSIsInNwbGljZSIsInIiLCJuIiwiZ2V0dGVyIiwiX19lc01vZHVsZSIsImQiLCJhIiwiZ2V0UHJvdG90eXBlT2YiLCJvYmoiLCJ0IiwidmFsdWUiLCJtb2RlIiwidGhpcyIsInRoZW4iLCJucyIsImRlZiIsImN1cnJlbnQiLCJpbmRleE9mIiwiZ2V0T3duUHJvcGVydHlOYW1lcyIsImZvckVhY2giLCJkZWZpbml0aW9uIiwibyIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImYiLCJjaHVua0lkIiwiYWxsIiwicmVkdWNlIiwicHJvbWlzZXMiLCJ1IiwiZyIsImdsb2JhbFRoaXMiLCJGdW5jdGlvbiIsInByb3AiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInNjcmlwdFVybCIsImltcG9ydFNjcmlwdHMiLCJkb2N1bWVudCIsImN1cnJlbnRTY3JpcHQiLCJzcmMiLCJzY3JpcHRzIiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJ0ZXN0IiwiRXJyb3IiLCJyZXBsYWNlIiwicCIsImluc3RhbGxlZENodW5rcyIsImNodW5rTG9hZGluZ0dsb2JhbCIsInBhcmVudENodW5rTG9hZGluZ0Z1bmN0aW9uIiwicHVzaCIsImJpbmQiLCJtb3JlTW9kdWxlcyIsInJ1bnRpbWUiLCJwb3AiXSwic291cmNlUm9vdCI6IiJ9